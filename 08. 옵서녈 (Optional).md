# 8. 옵서녈 (Optional)
## 1️⃣ 옵셔널(Optional) 기본
옵셔널(Optional)은 Swift의 언어적 특징을 가장 잘 나타내 주는 부분이자, 가장 중요한 부분이라 할 수 있다.

앞에서도 말했듯이 Swift는 안전성을 굉장히 중시하는 언어로 프로그래머가 행할 수 있는 실수를 문법 차원에서 미연에 방지할 수 있도록 되어 있는데, 
"**값이 있을 수도 있고 없을 수도 있는 경우**"를 별도의 `옵셔널(Optional)`이라는 문법으로 만든 것이 가장 대표적인 사례이다.

**값이 없을 수도 있는 데이터 타입이 왜 필요하지?** 라고 생각할 수 있으니 한 가지 예시를 들어보겠다.

서버로부터 사용자의 정보를 받아 화면에 그려야하는 경우를 생각해보자.   
데이터를 문제없이 받아오는 경우에는 상관없겠지만, 만약 데이터를 받아올 때 문제가 생겨 받아오지 못하는 경우에는 레이아웃을 잡는 작업 혹은 더 나아가 해당 데이터를 참조하고 있는 경우에는 참조할 데이터가 없어지는 **중대한 오류**가 발생하게 되는 것이다.

이렇게 값이 들어올 수도, 들어오지 않을 수도 있는 경우에 발생할 수 있는 오류를 방지하기 위해 Swift에서는 옵셔널(Optional)이라는 것을 사용한다.   
옵셔널을 표시하는 방법은 아주 간단하게 **데이터 타입(Data Type) 옆에 `?`를 붙여주기만 하면 된다.**

참고로, Swift에서 값이 들어오지 않는 경우는 `nil`이라는 키워드를 사용해 표현한다.

```swift
var number: Int           // Int형 변수
var optionalNumber: Int?  // Int Optional형 변수 (위 Int형과는 다른 데이터 타입)

number = nil              // [에러 발생] Int형에는 값이 들어오지 않는 경우를 처리할 수 없다.
optionalNumber = nil      // 옵셔널 변수에는 값이 들어오지 않는 경우를 처리할 수 있다.
optionalNumber = 100      // 물론, Int형도 저장할 수 있다.

print(optionalNumber)     // Optional(100) 출력
```

100이 들어있는 optionalNumber 변수를 `print` 했을 때,   
일반 100이 출력되는 것이 아니라, `Optional(100)`이 출력되는 것을 확인할 수 있다. (일반 100과는 분명 다른 자료형이다.)

이것은 값을 출력 했음에도 "100이 있을 수도 없을 수도 있는 상태"를 나타내고 있기 때문인데,   
그렇기 때문에 우리가 정상적으로 이 값을 사용하기 위해서는, 옵셔널에 들어있는 "**값을 꺼내는 과정**"이 반드시 필요하다.

이 과정을 `언래핑(Unwrapping)`이라고 부른다.   

언래핑에는 두 가지 방법이 있다.   
하나는, 옵셔널을 강제로 부수어 값을 꺼내 버리는 (과격한) **`강제 언래핑`** 방식.   
또다른 하나는, 값이 있는지 체크한 다음 값이 있을 경우에만 (친절하게) 동작을 하는 **`옵셔널 바인딩`** 방식으로 나누어진다.

<br>

## 2️⃣ 옵셔널 값을 꺼내기 위한 방법 (1) : 강제 언래핑
> 강제 언래핑은 매우 위험한 방법이니! 실전 코드에서 강제 언래핑 사용은 **지양**해야 한다.
> 강제 언래핑은 안전성을 중시하려는 기존 Swift의 원칙이 사라지는, 즉 프로그래머가 행할 수 있는 실수를 막을 방법이 없애는 것과 같음.

**강제 언래핑은 `!`키워드를 사용한다.**

옵셔널에 들어 있던 값을 `강제 언래핑`을 사용해서 꺼낸다면, 매우 간단하게 기존 옵셔널을 깨부수고 속에 있는 데이터를 가져온다.   

이렇게 `!`만 붙이면 되는 강제 언래핑 방식이 쉽고, 간단해 보이는데 강제 언래핑이 위험하다는 이유는 뭘까?   
옵셔널을 깨부수고 정상적으로 원래 데이터를 가져올 수 있는 경우는 옵셔널 안에 값이 들어있는 경우에 한정해서이다.   
즉, 다시 말해 옵셔널 안에 값이 들어있지 않은 경우에는, 없는 값에 대한 접근이므로 컴파일러는 에러를 발생시키기 때문에 위험하다고 말하는 것이다.   

```swift
// 강제 언래핑 작동
optionalNumber = 100
number = optionalNumber!

// 강제 언래핑 에러
optionalNumber = nil
number = optionalNumber!    // 값이 비어있기 때문에 런타임 오류가 발생 (빌드는 가능)
```

<br>

## 3️⃣ 옵셔널 값을 꺼내기 위한 방법 (2) : 옵셔널 바인딩
옵셔널 바인딩은 `if` 혹은 `guard` 구문을 사용해 옵셔널에 값이 있는지 없는지를 먼저 확인하고,   
만약 값이 있을 경우에는 해당 구문에서 지정한 (임시) 상수 혹은 변수에 할당해 이후 코드에서 사용하게 되는 방식이다.

`if문을 활용한 옵셔널 바인딩`
```swift
if let number: Int = optionalNumber {
    print(number)  // 옵셔널 바인딩 되어서 정상 출력
} else {
    print("The value is nil")
}
print(number)    // [에러 발생] number라는 상수는 임시 상수이므로 if-let 구문 안에서만 사용 가능하다.
```

`guard문을 활용한 옵셔널 바인딩`
```swift
/// guard-let을 활용한 옵셔널 바인딩

func checkOptional(optionalNum: Int?) {
    guard let number2 = optionalNum else { return }
    print(number2)  // guard문은 조건 이후에도 자유롭게 해당 상수를 사용할 수 있음
}
checkOptional(optionalNum: optionalNumber)   // 옵셔널 바인딩 되어서 정상 출력       
```

Swift 5.7부터는 임시 상수 혹은 변수의 이름이 불필요한 경우에는 아래와 같은 약식문을 사용할 수 있도록 지원한다.
```swift
var index: Int?
// 별도의 상수 혹은 변수 이름을 지정하지 않고 옵셔널 타입 변수값을 그대로 사용한다.
if let index {
    print(index)  
}
```
